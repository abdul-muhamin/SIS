"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.uploadConversationAttachment = void 0;
const buffer_js_1 = require("../../buffer.cjs");
async function uploadConversationAttachment(client, attachmentId, request) {
    const url = `/api/v1/Attachment/${attachmentId}/upload`;
    const buffer = (0, buffer_js_1.getBuffer)(request.data);
    const response = await client.clientFetch(url, {
        record: {
            file: {
                size: buffer.byteLength,
                type: request.type,
                name: request.name,
            },
        },
    });
    const { uploadRequest } = response;
    if (!uploadRequest) {
        throw new Error('Missing upload request');
    }
    await client.clientFetch(uploadRequest.url, {
        method: uploadRequest.method,
        headers: uploadRequest.headers,
        buffer: buffer,
        external: true,
    });
    return {
        id: response.id,
    };
}
exports.uploadConversationAttachment = uploadConversationAttachment;
